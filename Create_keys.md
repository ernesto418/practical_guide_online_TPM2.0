# Create Keys

We are going to create a private key ECC 256 inside the TPM.

But in the TPM we cannot create it like that, just a command. The reason is that the TPM has a very limited memory, therefore, it will store the private keys directly your computer!

But do not worry becasue it will be encrypted and protected cryptografically by another key, [wrapped](https://github.com/tpm2dev/tpm.dev.tutorials/blob/master/Intro/README.md#key-wrapping-and-resource-management) by another key.
That is why before create a private key we have to define which other TPM's key will wrap our key. Just, we have to create another key before our ECC 256 key, but wait, if we create another key, it has to be also wrapped :/ .

The question here is, which key is the first one in the hierarchies?, the first one that is created, and how is it protected? becasue it cannot be wraped by another one...
The first keys in the [Key Hierarchies](https://github.com/tpm2dev/tpm.dev.tutorials/blob/master/Intro/README.md#key-hierarchies) are the primary keys, keys that are generated by the fixed, secret and random seed.
They are generated using a pseudoramdon algorimts using always the same seed of the TPM ([well, not always, but that is another topic ;)](include_reference)), therefore, we can generate this primary key, destroy it and generete in the future exactly the same primary key
([we can also store it in the NV memory of the TPM](include_reference)).

So let create first the primary key with [tpm2_createprimary](https://github.com/tpm2-software/tpm2-tools/blob/master/man/tpm2_createprimary.1.md):

```
tpm2_createprimary -c primary.ctx
```

Whith this command we are creating the primary and leaving several options in default.

Now that we have this volatile key that we can recreate when needed, we can use it to wrap our ECC 256 key :D. Let's finally create our key with [tpm2_create](https://github.com/tpm2-software/tpm2-tools/blob/master/man/tpm2_create.1.md)

```
tpm2_create -C primary.ctx -G ecc256 -u obj.pub -r obj.priv
```

Congrats, we have created a key inside the TPM!!.

As you can see, we are providing 4 inputs:

-C  Refer to the key that is going to wrap our key, also known as the parent of our key

-G  Algorithm for our key

-u The path where store the [public portion](include_reference) of our key, here we can find some public information of our key that is not wrapped, like its [atributes](include_reference) or the public key (Warning: it is  not encrpted, but its integrity is protected and it is still needed to use our private key)

-r The path where store the [private portion of our key](include_reference) that is wraped by the primary key. It can only be read by the TPM ,well, if it has the correct atributes, that is why it is very important learn about them,
but the current default attributes define that the key is alwys protected by the TPM.

The next step would be to do a signature with the key, go to the [next course](course_2) for it.


